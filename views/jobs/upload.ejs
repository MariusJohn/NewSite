<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Upload Job - My Car Quote</title>
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/job-upload.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>

<div class="page-wrapper">

  <div class="logo-jobUpload">
    <a href="/">
      <img src="/img/logo-true.svg" alt="My Car Quote Logo">      
    </a>
  </div>

  <main class="upload-main">
    <section class="upload-container">
      <h1>Submit Your Vehicle Images</h1>
      <p class="upload-subtext">Please fill out the form and upload 5 to 8 images (max 5MB each)</p>

      <form id="uploadForm" action="/jobs/upload" method="POST" enctype="multipart/form-data" class="upload-form">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">

        <label for="name">Full Name:</label>
        <input type="text" id="name" name="customerName" placeholder="Your full name" required>
        <span class="error-message" id="name-error"></span>

        <label for="email">Email Address:</label>
        <input type="email" id="email" name="email" placeholder="Your email address" required>
        <span class="error-message" id="email-error"></span>

        <label for="telephone">Telephone number:</label>
        <input type="tel" id="telephone" name="telephone" placeholder="Your phone number" required>
        <span class="error-message" id="phone-error"></span>

        <label for="location">Location (Postcode):</label>
        <input type="text" id="location" name="postcode" placeholder="Your post code" required>
        <span class="error-message" id="postcode-error"></span>

            <div class="upload-file-wrapper">
              <!-- Input updated to prevent camera use -->
          <input
            type="file"
            id="images"
            name="images"
            accept="image/jpeg,image/png"
            multiple
            required
            style="display: none;"
          />


              <button type="button" id="showInstructionsBtn" class="choose-file-btn">Choose Images</button>

              <!-- Live preview stack -->
              <div id="preview-container" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px;"></div>

              <span id="images-feedback" class="upload-feedback"></span>
              <span id="images-error" class="error-message"></span>
            </div>


        <div class="g-recaptcha" data-sitekey="<%= recaptchaSiteKey %>"></div> 

        <button type="submit" class="upload-btn" id="submitBtn">Submit Job</button>

        <p id="form-error-message" style="color: rgb(41, 250, 26); display: none;"></p>
      </form>

      <!-- Upload Instructions Modal -->
      <div id="uploadInstructionsModal" class="upload-modal-overlay">
        <div class="upload-modal-content">
          <h2>Upload Guide</h2>
          <ol>
              <ul style="margin-top: 10px;">
                  <li>✅ Choose -<strong>Photo Library</strong> (📂)</li>
                  <li>❌ Avoid -<strong>Take Photo directly using camera</strong> (📷)</li>
               </ul>

            <li>📸 1 photo of the <strong>FRONT</strong> of your car</li>
            <li>📸 1 photo of the <strong>BACK</strong> of your car</li>
            <li>📸 1 photo of the <strong>DAMAGED SIDE</strong> of your car</li>
            <li>📸 1 photo with the <strong>OVERALL DAMAGE</strong></li>
            <li>📸 1 or more <strong>close-up photos</strong> of the damage</li>
          </ol>
  
            <p class="upload-tip" style="margin-top: 10px; color: #d9534f;">
                📱 On iPhones: Tap "Photo Library" instead of "Take Photo" to select multiple images at once.
              </p>

          <button id="closeModalBtn" class="modal-close-btn">Got it</button>
        </div>
      </div>

    </section>
  </main>

</div>

<%- include('../partials/footer') %>
<%- include('../partials/cookie-banner') %>

<script src="/js/job-upload.js"></script>
<script src="/js/cookie-banner.js"></script>
</body>
</html>
